version: "3.1"

slots:
  project_name:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  description:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  duration:
    type: float
    influence_conversation: true
    mappings:
      - type: custom
  complexity:
    type: float
    influence_conversation: true
    mappings:
      - type: custom
  sector:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  tasks:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  all_slots_filled:
    type: bool
    initial_value: false
    influence_conversation: true
    mappings:
      - type: custom
  recommendations:
    type: text
    influence_conversation: true
    mappings:
      - type: custom

  resources_confirmed:
    type: bool
    initial_value: false
    influence_conversation: true
    mappings:
      - type: custom

  skills_distribution:
    type: text
    influence_conversation: true
    mappings:
      - type: custom

  total_employees:
    type: float
    influence_conversation: true
    mappings:
      - type: custom

  salaries:
    type: text
    influence_conversation: true
    mappings:
      - type: custom

  current_role:
    type: text
    influence_conversation: true
    mappings:
      - type: custom

  all_salaries_collected:
    type: bool
    initial_value: false
    influence_conversation: true
    mappings:
      - type: custom

  fg_percentage:
    type: float
    influence_conversation: true
    mappings:
      - type: custom

  cost_estimation:
    type: text
    influence_conversation: true
    mappings:
      - type: custom

  cost_estimation_complete:
    type: bool
    initial_value: false
    influence_conversation: true
    mappings:
      - type: custom

  # --- New slots for RAG risk estimation ---
  pays:
    type: text
    influence_conversation: true
    mappings:
      - type: custom

  budget_initial_k:
    type: float
    influence_conversation: true
    mappings:
        - type: custom

  budget_final_k:
    type: float
    influence_conversation: true
    mappings:
      - type: custom

  ecart_budget_pct:
    type: float
    influence_conversation: true
    mappings:
      - type: custom

  taux_imposition_pct:
    type: float
    influence_conversation: true
    mappings:
      - type: custom

  mode_de_paiement:
    type: text
    influence_conversation: true
    mappings:
      - type: custom

  qualite_des_exigences_1_5:
    type: float
    influence_conversation: true
    mappings:
      - type: custom

    # These are the key control slots for the RAG process
  risk_fields_filled:
    type: bool
    initial_value: false
    influence_conversation: true
    mappings:
      - type: custom

  rag_risk_output:
    type: text
    influence_conversation: true
    initial_value: ""
    mappings:
      - type: custom


responses:
  utter_greet:
    - text: >
        Salut! üëã Je suis votre assistant expert en planification de projets üìÖ, en estimation des co√ªts üí∞ et en anticipation des risques ‚ö†Ô∏è
        Pour commencer,
  utter_project_details_complete:
    - text: "üéâ Super, j'ai toutes les infos n√©cessaires sur ton projet! Voici ce que j'ai not√© :\n- üè∑Ô∏è Nom du projet : {project_name}\n- üìù Description : {description}\n- ‚è≥ Dur√©e : {duration} mois\n- üìà Complexit√© : {complexity}/5\n- üè¢ Secteur : {sector}\n- üõ†Ô∏è T√¢ches principales : {tasks}\nMerci beaucoup! üöÄ"

  # Validation responses
  utter_insufficient_description:
    - text: "La description fournie semble insuffisante. Veuillez fournir davantage de d√©tails en incluant, par exemple, les objectifs, le contexte et les d√©fis du projet."
  utter_insufficient_tasks:
    - text: "Les informations concernant les t√¢ches semblent insuffisantes. Veuillez d√©tailler chaque t√¢che en pr√©cisant l'objectif, les ressources n√©cessaires, les d√©pendances et les r√©sultats attendus."
  utter_invalid_complexity:
     - text: "üìà Sur une √©chelle de 1 √† 5, quel serait le niveau de complexit√© de ton projet?"
  utter_generating_recommendations:
    - text: "Je suis en train de g√©n√©rer des recommandations pour votre projet. Un instant s'il vous pla√Æt..."

  utter_recommendation_error:
    - text: "Je suis d√©sol√©, mais je n'ai pas pu g√©n√©rer des recommandations pour votre projet. Veuillez r√©essayer plus tard."

  utter_ask_if_want_recommendations:
    - text: "Souhaitez-vous que je vous fournisse des recommandations pour ce projet?"

  utter_ask_followup_questions:
    - text: "Avez-vous des questions sur ces recommandations ou souhaitez-vous sugg√©rer des modifications? Vous pouvez me demander d'expliquer certains aspects ou sugg√©rer des ajustements concernant le nombre d'employ√©s, les comp√©tences requises, ou la r√©partition des ressources."

  utter_recommendations_modified:
    - text: "J'ai mis √† jour les recommandations selon votre demande. Voici les recommandations r√©vis√©es:"

  utter_out_of_scope:
    - text: "Je suis d√©sol√©, cela sort un peu de mon domaine d'expertise. Je suis ici pour vous aider avec la planification de projets et les recommandations associ√©es."
    - text: "Hmm, je ne suis pas s√ªr de pouvoir vous aider avec √ßa. Mon r√¥le est de vous assister pour collecter les informations de votre projet, valider ses aspects et vous fournir des recommandations."

  utter_guiding_prompt:
      - text: "Comment puis-je vous assister concernant votre projet aujourd'hui ?"
      - text: "Pouvons-nous revenir √† la planification de votre projet ? Quels d√©tails souhaitez-vous aborder ?"

  utter_silent_response:
      - text: ""

  utter_start_cost_estimation:
    - text: >
        üë®‚Äçüíª Parfait, je vais vous aider √† estimer le co√ªt total de votre projet.
        Je vais me baser sur les ressources recommand√©es pr√©c√©demment.

  utter_explain_cost_estimation_process:
    - text: |
          Pour estimer le co√ªt total, j'aurai besoin des informations suivantes:
          1Ô∏è‚É£ Confirmer les ressources humaines requises
          2Ô∏è‚É£ Le salaire mensuel pour chaque type de poste
          3Ô∏è‚É£ Le pourcentage de frais g√©n√©raux (FG%)

          Ensuite, je calculerai l'estimation totale du co√ªt du projet.

  utter_ask_for_resource_updates:
    - text: >
          Souhaitez-vous modifier le nombre de ressources ou la r√©partition des comp√©tences 
          avant de continuer avec l'estimation des co√ªts?

  utter_ask_fg_percentage:
    - text: >
          Quel est le pourcentage de frais g√©n√©raux (FG%) √† appliquer pour ce projet?
          (Par exemple, 20% pour les co√ªts indirects comme les locaux, l'√©lectricit√©, etc.)

  utter_ask_cost_followup:
    - text: >
          Avez-vous des questions sur cette estimation de co√ªt? Je peux vous fournir
          des explications suppl√©mentaires, des suggestions d'optimisation ou effectuer
          des ajustements si n√©cessaire.

  utter_finalize_cost_estimation:
    - text: >
          Parfait! L'estimation de co√ªt pour votre projet est maintenant finalis√©e.
          Si vous avez besoin de modifier l'estimation √† l'avenir ou si vous avez
          d'autres questions concernant votre projet, n'h√©sitez pas √† me demander.

  utter_present_cost_estimation:
    - text: |
        Voici l'estimation de co√ªt pour votre projet:
        
        üìä **R√©sum√© de l'estimation**:
        - Dur√©e du projet: {duration} mois
        - Co√ªt total des salaires: {total_salary_cost} ‚Ç¨
        - Frais g√©n√©raux ({fg_percentage}%): {overhead_cost} ‚Ç¨
        - **Co√ªt total du projet**: {total_project_cost} ‚Ç¨
        
        Avez-vous des questions sur cette estimation ou souhaitez-vous plus de d√©tails sur un aspect particulier?

  # --- New RAG risk estimation responses ---
  utter_start_risk_estimation:
    - text: >
        ‚ö†Ô∏è Nous allons maintenant passer √† l'estimation des risques du projet.
        Je vais avoir besoin de quelques informations compl√©mentaires pour une analyse pr√©cise.

  utter_risk_fields_collected:
    - text: >
        Parfait! J'ai maintenant toutes les informations n√©cessaires pour analyser les risques
        de votre projet. Je vais lancer l'estimation...

  utter_risk_fields_missing:
    - text: >
        Merci de me fournir les champs suivants pour proc√©der √† l'estimation des risques :
        {missing_fields_prompt}

  utter_risk_assessment_in_progress:
    - text: >
        Analyse des risques en cours... Je recherche des projets similaires et j'interroge mon syst√®me pour une estimation personnalis√©e.

  utter_risk_assessment_ready:
    - text: >
        Voici l'√©valuation d√©taill√©e des risques pour votre projet :
        {risk_assessment_summary}

  utter_ask_risk_followup:
    - text: >
        Avez-vous des questions concernant ces risques, souhaitez-vous des recommandations ou une explication d√©taill√©e pour un risque particulier ?

  utter_ask_if_want_risk_estimation:
    - text: "Voulez-vous que j'estime le risque de votre projet avec une analyse intelligente bas√©e sur des projets similaires ?"
actions:
    - action_validate_project_description
    - action_validate_project_tasks
    - action_check_project_slots
    - action_get_project_recommendations
    - action_present_recommendations
    - action_handle_recommendations_followup
    - action_confirm_resource_values
    - action_process_resource_update
    - action_ask_for_salaries
    - action_collect_salary_info
    - action_process_fg_percentage
    - action_calculate_cost_estimation
    - action_handle_cost_followup
    - action_present_cost_estimation
    # RAG Risk estimation actions
    - action_start_risk_estimation
    - action_collect_risk_fields
    - action_present_rag_risk_assessment
    - action_handle_rag_risk_followup
